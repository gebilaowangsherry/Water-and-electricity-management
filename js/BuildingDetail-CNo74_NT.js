import{c3 as A,bB as z,c4 as t,cb as a,cS as m,bC as s,cz as U,bF as u,bZ as I,b_ as P,cX as k,c$ as N}from"./vendor-Uhp0TdW6.js";import{_ as W}from"../assets/index-CDH_5kiC.js";import{i as y,g as v,u as R,a as G,b as M,c as V,d as j,e as E,f as F,h as X}from"./echarts-mBAUMFU9.js";import"./element-plus-IvV6zMkc.js";R([G,M,V,j,E,F,X]);const Z={name:"BuildingDetail",setup(){const w=k(),i=u(""),C=u(""),r=u(""),L={A:"1",B:"2",C:"3",D:"4"},x=u([]),c=u([]),g=u(null),o=u(null),n=u(null),f=u(null),D=async()=>{try{const e=await N.get("building.json"),d=Array.isArray(e.data)?e.data:e.data.buildings,p=L[i.value]||i.value;console.log("转换后的ID:",p),console.log("所有建筑ID:",d.map(b=>b.id));const h=d.find(b=>String(b.id)===String(p));return console.log("找到的建筑:",h),h}catch(e){return console.error("获取建筑数据失败:",e),null}},_=async()=>{i.value=w.params.id,r.value=await D(),r.value&&(C.value=r.value.name,T(),B())},T=()=>{r.value&&(x.value=r.value.floors.map(e=>({floor:`${e.floor}层`,waterUsage:e.monthlyTotal.waterUsage,waterCost:e.monthlyTotal.waterCost})),c.value=r.value.floors.map(e=>({floor:`${e.floor}层`,electricityUsage:e.monthlyTotal.electricityUsage,electricityCost:e.monthlyTotal.electricityCost})))},B=()=>{if(!r.value)return;const e=r.value.floors,d=e.map(l=>({value:l.monthlyTotal.electricityUsage,name:`${l.floor}层`})),p=e[0].weeklyUsage.map(l=>l.day),h=e.map(l=>({name:`${l.floor}层`,type:"line",data:l.weeklyUsage.map($=>$.electricityUsage)})),b=e.map(l=>({value:l.monthlyTotal.waterUsage,name:`${l.floor}层`})),S=e.map(l=>({name:`${l.floor}层`,type:"line",data:l.weeklyUsage.map($=>$.waterUsage)}));v(g.value).setOption({series:[{data:d}]}),v(o.value).setOption({legend:{data:e.map(l=>`${l.floor}层`)},xAxis:{data:p},series:h}),v(n.value).setOption({series:[{data:b}]}),v(f.value).setOption({legend:{data:e.map(l=>`${l.floor}层`)},xAxis:{data:p},series:S})},O=()=>{const e=y(g.value);e.setOption({title:{text:"用电分布",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center"},series:[{name:"用电量(度)",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[]}]});const d=y(o.value);d.setOption({title:{text:"用电趋势",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:[],bottom:10},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",name:"用电量(度)"},series:[]});const p=y(n.value);p.setOption({title:{text:"用水分布",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center"},series:[{name:"用水量(吨)",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[]}]});const h=y(f.value);h.setOption({title:{text:"用水趋势",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:[],bottom:10},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",name:"用水量(吨)"},series:[]}),window.addEventListener("resize",function(){e.resize(),d.resize(),p.resize(),h.resize()})};return I(()=>{O(),_()}),P(()=>w.params.id,(e,d)=>{e!==d&&_()}),{buildingName:C,waterTableData:x,electricityTableData:c,electricityPieChart:g,electricityLineChart:o,waterPieChart:n,waterLineChart:f}}},q={class:"card-header"},H={class:"card-header"},J={ref:"electricityPieChart",class:"chart"},K={ref:"electricityLineChart",class:"chart"},Q={ref:"waterPieChart",class:"chart"},Y={ref:"waterLineChart",class:"chart"};function ee(w,i,C,r,L,x){const c=m("el-table-column"),g=m("el-table"),o=m("el-card"),n=m("el-col"),f=m("el-row"),D=m("el-main"),_=m("el-container");return z(),A(_,null,{default:t(()=>[a(D,null,{default:t(()=>[a(f,{gutter:20,class:"row"},{default:t(()=>[a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>[s("div",q,[s("span",null,U(r.buildingName)+"用水情况",1)])]),default:t(()=>[a(g,{data:r.waterTableData,border:"",style:{width:"100%"},height:"300"},{default:t(()=>[a(c,{prop:"floor",label:"楼层",width:"80"}),a(c,{prop:"waterUsage",label:"用水量(吨)"}),a(c,{prop:"waterCost",label:"费用(元)"})]),_:1},8,["data"])]),_:1})]),_:1}),a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>[s("div",H,[s("span",null,U(r.buildingName)+"用电情况",1)])]),default:t(()=>[a(g,{data:r.electricityTableData,border:"",style:{width:"100%"},height:"300"},{default:t(()=>[a(c,{prop:"floor",label:"楼层",width:"80"}),a(c,{prop:"electricityUsage",label:"用电量(度)"}),a(c,{prop:"electricityCost",label:"费用(元)"})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),a(f,{gutter:20,class:"row"},{default:t(()=>[a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>i[0]||(i[0]=[s("div",{class:"card-header"},[s("span",null,"每层楼用电分布")],-1)])),default:t(()=>[s("div",J,null,512)]),_:1})]),_:1}),a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>i[1]||(i[1]=[s("div",{class:"card-header"},[s("span",null,"每层楼用电趋势")],-1)])),default:t(()=>[s("div",K,null,512)]),_:1})]),_:1})]),_:1}),a(f,{gutter:20,class:"row"},{default:t(()=>[a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>i[2]||(i[2]=[s("div",{class:"card-header"},[s("span",null,"每层楼用水分布")],-1)])),default:t(()=>[s("div",Q,null,512)]),_:1})]),_:1}),a(n,{span:12},{default:t(()=>[a(o,{class:"card"},{header:t(()=>i[3]||(i[3]=[s("div",{class:"card-header"},[s("span",null,"每层楼用水趋势")],-1)])),default:t(()=>[s("div",Y,null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const ce=W(Z,[["render",ee],["__scopeId","data-v-9077c9b2"]]);export{ce as default};
